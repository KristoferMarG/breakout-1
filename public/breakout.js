(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

function AudioSystem() {
  var _this = this;
  this.actx = new (AudioContext || webkitAudioContext)();
  this.bgGain = this.actx.createGain();
  this.mainGain = this.actx.createGain();

  this.bgGain.connect(this.actx.destination);
  this.mainGain.connect(this.actx.destination);

  this.play = function (buffer, loop) {
    var bs = _this.actx.createBufferSource();

    bs.loop = loop || false;
    bs.buffer = buffer;
    bs.connect(_this.mainGain);
    bs.start(0);
  };

  this.playBackground = function (buffer, loop) {
    var bs = _this.actx.createBufferSource();

    bs.loop = loop || false;
    bs.buffer = buffer;
    bs.connect(_this.bgGain);
    bs.start(0);
  };
}

module.exports = AudioSystem;

},{}],2:[function(require,module,exports){
"use strict";

var _ref = require("./gl-utils");

var clearContext = _ref.clearContext;
var _ref2 = require("./loaders");

var loadSound = _ref2.loadSound;
var loadImage = _ref2.loadImage;
var AudioSystem = require("./audio");

var raf = window.requestAnimationFrame;
var setInterval = window.setInterval;

var audioSystem = new AudioSystem();
var canvas = document.createElement("canvas");
var slider = document.createElement("input");
var button = document.createElement("button");

//perhaps wrap this?
var gl = canvas.getContext("webgl");

var settings = {
  audio: {
    bgVolume: 1,
    mainVolume: 1
  },
  video: {
    resolution: {
      width: 400,
      height: 600
    },
    bgColor: [0.3, 0, 0, 1]
  }
};

var cache = {
  sounds: {},
  sprites: {}
};

//debugging/dev
window.audioSystem = audioSystem;
window.settings = settings;

function makeUpdate() {
  return function update() {
    audioSystem.bgGain.gain.value = settings.audio.bgVolume;
    audioSystem.mainGain.gain.value = settings.audio.mainVolume;
  };
}

function makeRender(gl) {
  return function render() {
    gl.canvas.width = settings.video.resolution.width;
    gl.canvas.height = settings.video.resolution.height;

    clearContext(gl, settings.video.bgColor);
    raf(render);
  };
}

slider.type = "range";
slider.min = 0;
slider.max = 1;
slider.step = 0.1;
slider.value = settings.audio.bgVolume;
document.body.appendChild(slider);
document.body.appendChild(button);
document.body.appendChild(canvas);

slider.addEventListener("change", function (e) {
  console.log(this.value);
  settings.audio.bgVolume = this.value;
});

button.addEventListener("click", function (e) {
  audioSystem.play(cache.hadouken);
});

raf(makeRender(gl));
setInterval(makeUpdate(), 25);

loadSound(audioSystem.actx, "public/sounds/bgm1.mp3", function (err, buffer) {
  cache.bgm1 = buffer;
  audioSystem.playBackground(cache.bgm1, true);
});

loadSound(audioSystem.actx, "public/sounds/hadouken.mp3", function (err, buffer) {
  cache.hadouken = buffer;
});

},{"./audio":1,"./gl-utils":3,"./loaders":4}],3:[function(require,module,exports){
"use strict";

var utils = {};

var clearContext = function (gl, color) {
  if (color) gl.clearColor(color[0], color[1], color[2], color[3]);else gl.clearColor(0, 0, 0, 0);
  gl.clear(gl.COLOR_BUFFER_BIT);
};

var updateBuffer = function (gl, program, chunkSize, attrName, data) {
  var attribute = program.attributes[attrName];
  var buffer = program.buffers[attrName];

  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
  gl.bufferData(gl.ARRAY_BUFFER, data, gl.DYNAMIC_DRAW);
  gl.enableVertexAttribArray(attribute);
  gl.vertexAttribPointer(attribute, chunkSize, gl.FLOAT, false, 0, 0);
  return buffer;
};

//given src and type, compile and return shader
function compile(gl, shaderType, src) {
  var shader = gl.createShader(shaderType);

  gl.shaderSource(shader, src);
  gl.compileShader(shader);
  return shader;
}

//link your program w/ opengl
function link(gl, vs, fs) {
  var program = gl.createProgram();

  gl.attachShader(program, vs);
  gl.attachShader(program, fs);
  gl.linkProgram(program);
  return program;
}

/*
 * We want to create a wrapper for a loaded gl program
 * that includes pointers to all the uniforms and attributes
 * defined for this program.  This makes it more convenient
 * to change these values
 */
var LoadedProgram = function (gl, vSrc, fSrc) {
  var vs = compile(gl, gl.VERTEX_SHADER, vSrc);
  var fs = compile(gl, gl.FRAGMENT_SHADER, fSrc);
  var program = link(gl, vs, fs);
  var numAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);
  var numUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);
  var lp = {
    vertex: {
      src: vSrc,
      shader: vs
    },
    fragment: {
      src: fSrc,
      shader: fs
    },
    program: program,
    uniforms: {},
    attributes: {},
    buffers: {}
  };
  var aName;
  var uName;

  for (var i = 0; i < numAttributes; ++i) {
    aName = gl.getActiveAttrib(program, i).name;
    lp.attributes[aName] = gl.getAttribLocation(program, aName);
    lp.buffers[aName] = gl.createBuffer();
  }

  for (var j = 0; j < numUniforms; ++j) {
    uName = gl.getActiveUniform(program, j).name;
    lp.uniforms[uName] = gl.getUniformLocation(program, uName);
  }

  return lp;
};

utils.clearContext = clearContext;
utils.updateBuffer = updateBuffer;
utils.LoadedProgram = LoadedProgram;
module.exports = utils;

},{}],4:[function(require,module,exports){
"use strict";

function fetch(type, path, cb) {
  var xhr = new XMLHttpRequest();

  xhr.responseType = type;
  xhr.onload = function () {
    return cb(null, xhr.response);
  };
  xhr.onerror = function () {
    return cb(new Error("Could not load " + path));
  };
  xhr.open("GET", path, true);
  xhr.send(null);
}

function loadImage(path, cb) {
  var i = new Image();

  i.onload = function () {
    return cb(null, i);
  };
  i.onerror = function () {
    return cb(new Error("Could not load " + path));
  };
  i.src = path;
}

function loadSound(audioCtx, path, cb) {
  fetch("arraybuffer", path, function (err, binary) {
    if (err) return cb(err);

    var decodeSuccess = function (buffer) {
      return cb(null, buffer);
    };
    var decodeFailure = cb;

    audioCtx.decodeAudioData(binary, decodeSuccess, decodeFailure);
  });
}

module.exports.loadImage = loadImage;
module.exports.loadSound = loadSound;
module.exports.fetch = fetch;

},{}]},{},[2])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvc3RldmVua2FuZS9zaW1wbGVwb25nL3NyYy9hdWRpby5qcyIsIi9Vc2Vycy9zdGV2ZW5rYW5lL3NpbXBsZXBvbmcvc3JjL2JyZWFrb3V0LmpzIiwiL1VzZXJzL3N0ZXZlbmthbmUvc2ltcGxlcG9uZy9zcmMvZ2wtdXRpbHMuanMiLCIvVXNlcnMvc3RldmVua2FuZS9zaW1wbGVwb25nL3NyYy9sb2FkZXJzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxTQUFTLFdBQVcsR0FBSTs7QUFDdEIsTUFBSSxDQUFDLElBQUksR0FBTyxJQUFJLENBQUMsWUFBWSxJQUFJLGtCQUFrQixDQUFDLEVBQUUsQ0FBQTtBQUMxRCxNQUFJLENBQUMsTUFBTSxHQUFLLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUE7QUFDdEMsTUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFBOztBQUV0QyxNQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFBO0FBQzFDLE1BQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUE7O0FBRTVDLE1BQUksQ0FBQyxJQUFJLEdBQUcsVUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFLO0FBQzVCLFFBQUksRUFBRSxHQUFHLE1BQUssSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUE7O0FBRXZDLE1BQUUsQ0FBQyxJQUFJLEdBQUssSUFBSSxJQUFJLEtBQUssQ0FBQTtBQUN6QixNQUFFLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQTtBQUNsQixNQUFFLENBQUMsT0FBTyxDQUFDLE1BQUssUUFBUSxDQUFDLENBQUE7QUFDekIsTUFB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Q0FBQTtBQUN6RCxHQUFDLENBQUMsR0FBRyxHQUFPLElBQUksQ0FBQTtDQUNqQjs7QUFFRCxTQUFTLFNBQVMsQ0FBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRTtBQUN0QyxPQUFLLENBQUMsYUFBYSxFQUFFLElBQUksRUFBRSxVQUFVLEdBQUcsRUFBRSxNQUFNLEVBQUU7QUFDaEQsUUFBSSxHQUFHLEVBQUUsT0FBTyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUE7O0FBRXZCLFFBQUksYUFBYSxHQUFHLFVBQUMsTUFBTTthQUFLLEVBQUUsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDO0tBQUEsQ0FBQTtBQUNoRCxRQUFJLGFBQWEsR0FBRyxFQUFFLENBQUE7O0FBRXRCLFlBQVEsQ0FBQyxlQUFlLENBQUMsTUFBTSxFQUFFLGFBQWEsRUFBRSxhQUFhLENBQUMsQ0FBQTtHQUMvRCxDQUFDLENBQUE7Q0FDSDs7QUFFRCxNQUFNLENBQUMsT0FBTyxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUE7QUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFBO0FBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxHQUFPLEtBQUssQ0FBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJmdW5jdGlvbiBBdWRpb1N5c3RlbSAoKSB7XG4gIHRoaXMuYWN0eCAgICAgPSBuZXcgKEF1ZGlvQ29udGV4dCB8fCB3ZWJraXRBdWRpb0NvbnRleHQpKClcbiAgdGhpcy5iZ0dhaW4gICA9IHRoaXMuYWN0eC5jcmVhdGVHYWluKClcbiAgdGhpcy5tYWluR2FpbiA9IHRoaXMuYWN0eC5jcmVhdGVHYWluKClcblxuICB0aGlzLmJnR2Fpbi5jb25uZWN0KHRoaXMuYWN0eC5kZXN0aW5hdGlvbilcbiAgdGhpcy5tYWluR2Fpbi5jb25uZWN0KHRoaXMuYWN0eC5kZXN0aW5hdGlvbilcblxuICB0aGlzLnBsYXkgPSAoYnVmZmVyLCBsb29wKSA9PiB7XG4gICAgbGV0IGJzID0gdGhpcy5hY3R4LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpXG5cbiAgICBicy5sb29wICAgPSBsb29wIHx8IGZhbHNlXG4gICAgYnMuYnVmZmVyID0gYnVmZmVyXG4gICAgYnMuY29ubmVjdCh0aGlzLm1haW5HYWluKVxuICAgIGJzLnN0YXJ0KDApXG4gIH1cblxuICB0aGlzLnBsYXlCYWNrZ3JvdW5kID0gKGJ1ZmZlciwgbG9vcCkgPT4ge1xuICAgIGxldCBicyA9IHRoaXMuYWN0eC5jcmVhdGVCdWZmZXJTb3VyY2UoKVxuXG4gICAgYnMubG9vcCA9IGxvb3AgfHwgZmFsc2VcbiAgICBicy5idWZmZXIgPSBidWZmZXJcbiAgICBicy5jb25uZWN0KHRoaXMuYmdHYWluKVxuICAgIGJzLnN0YXJ0KDApXG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBBdWRpb1N5c3RlbVxuIiwibGV0IHtjbGVhckNvbnRleHR9ID0gcmVxdWlyZShcIi4vZ2wtdXRpbHNcIilcbmxldCB7bG9hZFNvdW5kLCBsb2FkSW1hZ2V9ID0gcmVxdWlyZShcIi4vbG9hZGVyc1wiKVxubGV0IEF1ZGlvU3lzdGVtID0gcmVxdWlyZShcIi4vYXVkaW9cIilcblxubGV0IHJhZiAgICAgICAgID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZVxubGV0IHNldEludGVydmFsID0gd2luZG93LnNldEludGVydmFsXG5cbmxldCBhdWRpb1N5c3RlbSA9IG5ldyBBdWRpb1N5c3RlbVxubGV0IGNhbnZhcyAgICAgID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKVxubGV0IHNsaWRlciAgICAgID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpXG5sZXQgYnV0dG9uICAgICAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpXG5cbi8vcGVyaGFwcyB3cmFwIHRoaXM/XG5sZXQgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dChcIndlYmdsXCIpXG5cbmxldCBzZXR0aW5ncyA9IHtcbiAgYXVkaW86IHtcbiAgICBiZ1ZvbHVtZTogMS4wLFxuICAgIG1haW5Wb2x1bWU6ICAgIDEuMFxuICB9LFxuICB2aWRlbzoge1xuICAgIHJlc29sdXRpb246IHtcbiAgICAgIHdpZHRoOiA0MDAsXG4gICAgICBoZWlnaHQ6IDYwMFxuICAgIH0sXG4gICAgYmdDb2xvcjogWzAuMywgMC4wLCAwLjAsIDEuMF1cbiAgfVxufVxuXG5sZXQgY2FjaGUgPSB7XG4gIHNvdW5kczogIHt9LFxuICBzcHJpdGVzOiB7fVxufVxuXG4vL2RlYnVnZ2luZy9kZXZcbndpbmRvdy5hdWRpb1N5c3RlbSA9IGF1ZGlvU3lzdGVtXG53aW5kb3cuc2V0dGluZ3MgICAgPSBzZXR0aW5nc1xuXG5mdW5jdGlvbiBtYWtlVXBkYXRlICgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZSAoKSB7XG4gICAgYXVkaW9TeXN0ZW0uYmdHYWluLmdhaW4udmFsdWUgICA9IHNldHRpbmdzLmF1ZGlvLmJnVm9sdW1lXG4gICAgYXVkaW9TeXN0ZW0ubWFpbkdhaW4uZ2Fpbi52YWx1ZSA9IHNldHRpbmdzLmF1ZGlvLm1haW5Wb2x1bWVcbiAgfVxufVxuXG5mdW5jdGlvbiBtYWtlUmVuZGVyIChnbCkge1xuICByZXR1cm4gZnVuY3Rpb24gcmVuZGVyICgpIHtcbiAgICBnbC5jYW52YXMud2lkdGggID0gc2V0dGluZ3MudmlkZW8ucmVzb2x1dGlvbi53aWR0aFxuICAgIGdsLmNhbnZhcy5oZWlnaHQgPSBzZXR0aW5ncy52aWRlby5yZXNvbHV0aW9uLmhlaWdodFxuXG4gICAgY2xlYXJDb250ZXh0KGdsLCBzZXR0aW5ncy52aWRlby5iZ0NvbG9yKVxuICAgIHJhZihyZW5kZXIpIFxuICB9XG59XG5cbnNsaWRlci50eXBlICA9IFwicmFuZ2VcIlxuc2xpZGVyLm1pbiAgID0gMFxuc2xpZGVyLm1heCAgID0gMVxuc2xpZGVyLnN0ZXAgID0gMC4xXG5zbGlkZXIudmFsdWUgPSBzZXR0aW5ncy5hdWRpby5iZ1ZvbHVtZVxuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzbGlkZXIpXG5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGJ1dHRvbilcbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2FudmFzKVxuXG5zbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBmdW5jdGlvbiAoZSkge1xuICBjb25zb2xlLmxvZyh0aGlzLnZhbHVlKVxuICBzZXR0aW5ncy5hdWRpby5iZ1ZvbHVtZSA9IHRoaXMudmFsdWVcbn0pXG5cbmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcbiAgYXVkaW9TeXN0ZW0ucGxheShjYWNoZS5oYWRvdWtlbilcbn0pXG5cbnJhZihtYWtlUmVuZGVyKGdsKSlcbnNldEludGVydmFsKG1ha2VVcGRhdGUoKSwgMjUpXG5cbmxvYWRTb3VuZChhdWRpb1N5c3RlbS5hY3R4LCBcInB1YmxpYy9zb3VuZHMvYmdtMS5tcDNcIiwgZnVuY3Rpb24gKGVyciwgYnVmZmVyKSB7XG4gIGNhY2hlLmJnbTEgPSBidWZmZXJcbiAgYXVkaW9TeXN0ZW0ucGxheUJhY2tncm91bmQoY2FjaGUuYmdtMSwgdHJ1ZSlcbn0pXG5cbmxvYWRTb3VuZChhdWRpb1N5c3RlbS5hY3R4LCBcInB1YmxpYy9zb3VuZHMvaGFkb3VrZW4ubXAzXCIsIGZ1bmN0aW9uIChlcnIsIGJ1ZmZlcikge1xuICBjYWNoZS5oYWRvdWtlbiA9IGJ1ZmZlclxufSlcbiIsInZhciB1dGlscyA9IHt9XG5cbnZhciBjbGVhckNvbnRleHQgPSBmdW5jdGlvbiAoZ2wsIGNvbG9yKSB7XG4gIGlmIChjb2xvcikgZ2wuY2xlYXJDb2xvcihjb2xvclswXSwgY29sb3JbMV0sIGNvbG9yWzJdLCBjb2xvclszXSlcbiAgZWxzZSAgICAgICBnbC5jbGVhckNvbG9yKDAuMCwgMC4wLCAwLjAsIDAuMClcbiAgZ2wuY2xlYXIoZ2wuQ09MT1JfQlVGRkVSX0JJVClcbn1cblxudmFyIHVwZGF0ZUJ1ZmZlciA9IGZ1bmN0aW9uIChnbCwgcHJvZ3JhbSwgY2h1bmtTaXplLCBhdHRyTmFtZSwgZGF0YSkge1xuICB2YXIgYXR0cmlidXRlID0gcHJvZ3JhbS5hdHRyaWJ1dGVzW2F0dHJOYW1lXVxuICB2YXIgYnVmZmVyICAgID0gcHJvZ3JhbS5idWZmZXJzW2F0dHJOYW1lXVxuXG4gIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBidWZmZXIpXG4gIGdsLmJ1ZmZlckRhdGEoZ2wuQVJSQVlfQlVGRkVSLCBkYXRhLCBnbC5EWU5BTUlDX0RSQVcpXG4gIGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KGF0dHJpYnV0ZSlcbiAgZ2wudmVydGV4QXR0cmliUG9pbnRlcihhdHRyaWJ1dGUsIGNodW5rU2l6ZSwgZ2wuRkxPQVQsIGZhbHNlLCAwLCAwKVxuICByZXR1cm4gYnVmZmVyXG59XG5cbi8vZ2l2ZW4gc3JjIGFuZCB0eXBlLCBjb21waWxlIGFuZCByZXR1cm4gc2hhZGVyXG5mdW5jdGlvbiBjb21waWxlIChnbCwgc2hhZGVyVHlwZSwgc3JjKSB7XG4gIHZhciBzaGFkZXIgPSBnbC5jcmVhdGVTaGFkZXIoc2hhZGVyVHlwZSlcblxuICBnbC5zaGFkZXJTb3VyY2Uoc2hhZGVyLCBzcmMpXG4gIGdsLmNvbXBpbGVTaGFkZXIoc2hhZGVyKVxuICByZXR1cm4gc2hhZGVyXG59XG5cbi8vbGluayB5b3VyIHByb2dyYW0gdy8gb3BlbmdsXG5mdW5jdGlvbiBsaW5rIChnbCwgdnMsIGZzKSB7XG4gIHZhciBwcm9ncmFtID0gZ2wuY3JlYXRlUHJvZ3JhbSgpXG5cbiAgZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIHZzKSBcbiAgZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIGZzKSBcbiAgZ2wubGlua1Byb2dyYW0ocHJvZ3JhbSlcbiAgcmV0dXJuIHByb2dyYW1cbn1cblxuLypcbiAqIFdlIHdhbnQgdG8gY3JlYXRlIGEgd3JhcHBlciBmb3IgYSBsb2FkZWQgZ2wgcHJvZ3JhbVxuICogdGhhdCBpbmNsdWRlcyBwb2ludGVycyB0byBhbGwgdGhlIHVuaWZvcm1zIGFuZCBhdHRyaWJ1dGVzXG4gKiBkZWZpbmVkIGZvciB0aGlzIHByb2dyYW0uICBUaGlzIG1ha2VzIGl0IG1vcmUgY29udmVuaWVudFxuICogdG8gY2hhbmdlIHRoZXNlIHZhbHVlc1xuICovXG52YXIgTG9hZGVkUHJvZ3JhbSA9IGZ1bmN0aW9uIChnbCwgdlNyYywgZlNyYykge1xuICB2YXIgdnMgICAgICAgICAgICA9IGNvbXBpbGUoZ2wsIGdsLlZFUlRFWF9TSEFERVIsIHZTcmMpXG4gIHZhciBmcyAgICAgICAgICAgID0gY29tcGlsZShnbCwgZ2wuRlJBR01FTlRfU0hBREVSLCBmU3JjKVxuICB2YXIgcHJvZ3JhbSAgICAgICA9IGxpbmsoZ2wsIHZzLCBmcylcbiAgdmFyIG51bUF0dHJpYnV0ZXMgPSBnbC5nZXRQcm9ncmFtUGFyYW1ldGVyKHByb2dyYW0sIGdsLkFDVElWRV9BVFRSSUJVVEVTKVxuICB2YXIgbnVtVW5pZm9ybXMgICA9IGdsLmdldFByb2dyYW1QYXJhbWV0ZXIocHJvZ3JhbSwgZ2wuQUNUSVZFX1VOSUZPUk1TKVxuICB2YXIgbHAgPSB7XG4gICAgdmVydGV4OiB7XG4gICAgICBzcmM6ICAgIHZTcmMsXG4gICAgICBzaGFkZXI6IHZzIFxuICAgIH0sXG4gICAgZnJhZ21lbnQ6IHtcbiAgICAgIHNyYzogICAgZlNyYyxcbiAgICAgIHNoYWRlcjogZnMgXG4gICAgfSxcbiAgICBwcm9ncmFtOiAgICBwcm9ncmFtLFxuICAgIHVuaWZvcm1zOiAgIHt9LCBcbiAgICBhdHRyaWJ1dGVzOiB7fSxcbiAgICBidWZmZXJzOiAgICB7fVxuICB9XG4gIHZhciBhTmFtZVxuICB2YXIgdU5hbWVcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IG51bUF0dHJpYnV0ZXM7ICsraSkge1xuICAgIGFOYW1lICAgICAgICAgICAgICAgID0gZ2wuZ2V0QWN0aXZlQXR0cmliKHByb2dyYW0sIGkpLm5hbWVcbiAgICBscC5hdHRyaWJ1dGVzW2FOYW1lXSA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHByb2dyYW0sIGFOYW1lKVxuICAgIGxwLmJ1ZmZlcnNbYU5hbWVdICAgID0gZ2wuY3JlYXRlQnVmZmVyKClcbiAgfVxuXG4gIGZvciAodmFyIGogPSAwOyBqIDwgbnVtVW5pZm9ybXM7ICsraikge1xuICAgIHVOYW1lICAgICAgICAgICAgICA9IGdsLmdldEFjdGl2ZVVuaWZvcm0ocHJvZ3JhbSwgaikubmFtZVxuICAgIGxwLnVuaWZvcm1zW3VOYW1lXSA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCB1TmFtZSlcbiAgfVxuXG4gIHJldHVybiBscCBcbn1cblxudXRpbHMuY2xlYXJDb250ZXh0ICA9IGNsZWFyQ29udGV4dFxudXRpbHMudXBkYXRlQnVmZmVyICA9IHVwZGF0ZUJ1ZmZlclxudXRpbHMuTG9hZGVkUHJvZ3JhbSA9IExvYWRlZFByb2dyYW1cbm1vZHVsZS5leHBvcnRzICAgICAgPSB1dGlsc1xuIiwiZnVuY3Rpb24gZmV0Y2ggKHR5cGUsIHBhdGgsIGNiKSB7XG4gIGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3RcblxuICB4aHIucmVzcG9uc2VUeXBlID0gdHlwZVxuICB4aHIub25sb2FkICAgICAgID0gKCkgPT4gY2IobnVsbCwgeGhyLnJlc3BvbnNlKVxuICB4aHIub25lcnJvciAgICAgID0gKCkgPT4gY2IobmV3IEVycm9yKFwiQ291bGQgbm90IGxvYWQgXCIgKyBwYXRoKSlcbiAgeGhyLm9wZW4oXCJHRVRcIiwgcGF0aCwgdHJ1ZSlcbiAgeGhyLnNlbmQobnVsbClcbn1cblxuZnVuY3Rpb24gbG9hZEltYWdlIChwYXRoLCBjYikge1xuICBsZXQgaSA9IG5ldyBJbWFnZVxuXG4gIGkub25sb2FkICA9ICgpID0+IGNiKG51bGwsIGkpXG4gIGkub25lcnJvciA9ICgpID0+IGNiKG5ldyBFcnJvcihcIkNvdWxkIG5vdCBsb2FkIFwiICsgcGF0aCkpXG4gIGkuc3JjICAgICA9IHBhdGhcbn1cblxuZnVuY3Rpb24gbG9hZFNvdW5kIChhdWRpb0N0eCwgcGF0aCwgY2IpIHtcbiAgZmV0Y2goXCJhcnJheWJ1ZmZlclwiLCBwYXRoLCBmdW5jdGlvbiAoZXJyLCBiaW5hcnkpIHtcbiAgICBpZiAoZXJyKSByZXR1cm4gY2IoZXJyKVxuXG4gICAgbGV0IGRlY29kZVN1Y2Nlc3MgPSAoYnVmZmVyKSA9PiBjYihudWxsLCBidWZmZXIpXG4gICAgbGV0IGRlY29kZUZhaWx1cmUgPSBjYlxuXG4gICAgYXVkaW9DdHguZGVjb2RlQXVkaW9EYXRhKGJpbmFyeSwgZGVjb2RlU3VjY2VzcywgZGVjb2RlRmFpbHVyZSlcbiAgfSlcbn1cblxubW9kdWxlLmV4cG9ydHMubG9hZEltYWdlID0gbG9hZEltYWdlXG5tb2R1bGUuZXhwb3J0cy5sb2FkU291bmQgPSBsb2FkU291bmRcbm1vZHVsZS5leHBvcnRzLmZldGNoICAgICA9IGZldGNoXG4iXX0=
